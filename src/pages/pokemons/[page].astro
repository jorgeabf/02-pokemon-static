---
import type { GetStaticPaths } from 'astro'
import PokemonCard from '@components/PokemonCard.astro'
import MainLayout from '@layouts/MainLayout.astro'
import { Icon } from 'astro-icon/components'

export const getStaticPaths = (async ({ paginate }) => {
  const API_URL = 'https://pokeapi.co/api/v2/pokemon?limit=151'
  const response = await fetch(API_URL)
  const { results } = (await response.json()) as PokemonListResponse

  return paginate(results, { pageSize: 18 })
}) satisfies GetStaticPaths

const { page } = Astro.props
const { currentPage, lastPage, url, data } = page
---

<MainLayout title={`Pokémons ${currentPage} de ${lastPage}`}>
  <section class='relative'>
    <nav
      class='flex justify-between space-x-4 mb-8 gap-4 absolute -top-[82px] w-full'
    >
      <a
        href={url.prev}
        class:list={['nav-btn', { disabled: !url.prev }]}
      >
        <Icon
          name='arrow-left'
          size={32}
          title='Página anterior'
        />
      </a>
      <a
        href={url.next}
        class:list={['nav-btn', { disabled: !url.next }]}
      >
        <Icon
          name='arrow-right'
          size={32}
          title='Siguiente página'
        />
      </a>
    </nav>
    <ul
      aria-label='Pokemon listado'
      class='grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4'
    >
      {
        data.map(({ name, url }) => (
          <PokemonCard
            name={name}
            url={url}
          />
        ))
      }
    </ul>
  </section>
</MainLayout>

<style>
  .nav-btn {
    @apply px-1 py-1 bg-orange-700 rounded-xl;
  }

  .disabled {
    @apply cursor-not-allowed bg-slate-500 pointer-events-none;
  }
</style>
